<!-- Solution developed by Jasmine Li (Student in Rutgers Jan 16 - NB Class) -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Correct Color Picker</title>

    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.1.0.js" integrity="sha256-slogkvB1K3VOkzAI8QITxV3VzpOnkeNVsKvtkYLMjfk=" crossorigin="anonymous"></script>

    <link href="./assets/css/reset.css" rel="stylesheet">
    <link href="./assets/css/bootstrap.min.css" rel="stylesheet"></link>
    <link href="./assets/css/style.css" rel="stylesheet">
    <script src="./assets/javascript/game.js" type="text/javascript"></script>
</head>

<body>

    <div class="container">
        <div class="row">

            <div class="col-lg-6 fighters">

            </div>
            <div class="rpg col-md-6">Star Wars RPG !</div>


        </div>


        <div class="row header">Your Character</div>

        <div class="row">

            <div class=" col-md-6 yourCharacter"></div>
        </div>


        <div class="row header">Enemies Available to Attack</div>
        <div class="row">
            <div class=" col-md-6 enemiesAvailable"></div>
        </div>

        <div class="row header">
            <div class="fightSection">Fight Section</div>
        </div>

        <div class="row header">
            <button class="attack">Attack</button>
        </div>

        <div class="row header">Defender</div>

        <div class="row">
            <div class=" col-md-6 defender"></div>
        </div>

    </div>


    <script>
        var attackerChosen = false;
        var defenderChosen = false;

        var attacker = [];
        var attackerIndex = 0;
        var defender = [];
        var defenderIndex = 0;



        var combatant = new Array(4);
        combatant[0] = new jedi('Obi Wan', 'obiWan.png', 120, 6, 0, 'false');
        combatant[1] = new jedi('Luke Skywalker', 'luke.jpg', 100, 6, 0, 'false');
        combatant[2] = new jedi('Darth Sidious', 'darthSidious.jpeg', 150, 6, 0, 'false');
        combatant[3] = new jedi('Darth Vader', 'darthVader.jpg', 180, 6, 0, 'false');

        function jedi(name, image, health, attack, counter, chosen, state) {
            this.name = name;
            this.image = image;
            this.health = health;
            this.attack = attack;
            this.counter = counter;
            this.status = 'available';
            this.state = state;

        }

        $(document).ready(function () {

            function setCharacter(index) {
                $(".fighters").empty();

                if (combatant[index].status === 'available') {

                    var $attackers = $("<div/>").addClass("jedi col-sm-3").attr('jedi-id', index).html('<span>' + combatant[index].name + '</span><img src=./assets/images/' + combatant[index].image + ' class="img-responsive">' + '<span>' + combatant[index].health + '</span>');


                    combatant[index].status = 'unavailable'
                        //  attackerChosen = true;
                    combatant[index].state = true;
                    attackerIndex = index;
                    attacker[index] = combatant[index];

                    $(".yourCharacter").append($attackers);

                }

                //               displayJedi();
                setEnemies();

            }

            function setEnemies(index) {

                $(".fighters").empty();

                for (var i = 0; combatant.length > i; i++) {

                    if (combatant[i].status === 'available') {

                        var $fighters = $("<div/>").addClass("jedi col-sm-3").attr('jedi-id', i).html('<span>' + combatant[i].name + '</span><img src=./assets/images/' + combatant[i].image + ' class="img-responsive">' + '<span>' + combatant[i].health + '</span>').css('border', 'solid black').css('background-color', 'red');

                        //defenderChosen = true;

                        $(".enemiesAvailable").append($fighters);
                    }
                }
            }

            function setDefender(index) {

                $(".enemiesAvailable").empty();


                if (combatant[index].status === 'available')

                    var $defenders = $("<div/>").addClass("jedi col-sm-3").attr('jedi-id', index).html('<span>' + combatant[index].name + '</span><img src=./assets/images/' + combatant[index].image + ' class="img-responsive">' + '<span>' + combatant[index].health + '</span>');


                combatant[index].status = 'unavailable'
                    //  defenderChosen = true;
                combatant[index].state = true;
                defenderIndex = index;
                defender[index] = combatant[index];

                setEnemies(index);

                $(".defender").append($defenders);


            }


            function displayJedi() {

                $(".fighters").empty();

                for (var i = 0; combatant.length > i; i++) {

                    if (combatant[i].status === 'available') {

                        var $fighters = $("<div/>").addClass("jedi col-sm-3").attr('jedi-id', i).html('<span>' + combatant[i].name + '</span><img src=./assets/images/' + combatant[i].image + ' class="img-responsive">' + '<span>' + combatant[i].health + '</span>');

                        $(".fighters").append($fighters);
                    }

                }


                $(".jedi").on('click', function () {

                    if (this.getAttribute('jedi-id') == '0') {

                        displayJedi();

                        if (!attackerChosen) {
                            setCharacter(0);
                        }

                    }

                    if (this.getAttribute('jedi-id') == '1') {

                        displayJedi();

                        if (!attackerChosen) {
                            setCharacter(1);
                        }

                    }

                    if (this.getAttribute('jedi-id') == '2') {


                        displayJedi();
                        if (!attackerChosen) {
                            setCharacter(2);
                        }
                    }

                    if (this.getAttribute('jedi-id') == '3') {

                        displayJedi();
                        if (!attackerChosen) {
                            setCharacter(3);
                        }

                    }

                    $(".jedi").on('click', function () {
                        if (this.getAttribute('jedi-id') == '0') {

                            if (!defenderChosen) {
                                setDefender(0)
                            }

                        }

                        if (this.getAttribute('jedi-id') == '1') {

                            if (!defenderChosen) {
                                setDefender(1)
                            }
                        }

                        if (this.getAttribute('jedi-id') == '2') {

                            if (!defenderChosen) {
                                setDefender(2)
                            }
                        }
                        if (this.getAttribute('jedi-id') == '3') {

                            if (!defenderChosen) {
                                setDefender(3)
                            }
                        }


                        $(".attack").on('click', function () {



                            console.log(attacker[0]);
                            console.log(defender[1]);



                            if ((attacker[attackerIndex].state === true) && (defender[defenderIndex].state === true)) {

                                $(".yourCharacter").empty();

                                attacker[attackerIndex].health = attacker[attackerIndex].health - defender[defenderIndex].attack;
                                
                                defender[defenderIndex].health = defender[defenderIndex].health - attacker[attackerIndex].attack;

                                var $attackers = $("<div/>").addClass("jedi col-sm-3").attr('jedi-id', attackerIndex).html('<span>' + attacker[attackerIndex].name + '</span><img src=./assets/images/' + attacker[attackerIndex].image + ' class="img-responsive">' + '<span>' + attacker[attackerIndex].health + '</span>');
                                
                                $(".yourCharacter").append($attackers);

                                
                                
                                $(".defender").empty();


                                var $defenders = $("<div/>").addClass("jedi col-sm-3").attr('jedi-id', defenderIndex).html('<span>' + defender[defenderIndex].name + '</span><img src=./assets/images/' + defender[defenderIndex].image + ' class="img-responsive">' + '<span>' + defender[defenderIndex].health + '</span>');


                                $(".defender").append($defenders);
                                

                            }

                        })


                    })
                })
            }

            displayJedi();
        })
    </script>
</body>

</html>